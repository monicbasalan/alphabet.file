index_slot_to_size={};index_slots_render=[];index_slots_add=[];var cygnus_tid=4;var OPEN_MARKET="IOM";var PRIVATE_MARKET="IPM";function cygnus_report_blanks(targets){if(typeof targets==="undefined"||targets.length<1){console.log("Error: Attempted to report blanks, but no blank targets specified!.");return}var url=window.location.protocol==="https:"?"https://as-sec.casalemedia.com":"http://as.casalemedia.com";url+="/headerstats?type=RT&s="+cygnus_index_args.siteID+"&u="+encodeURIComponent(location.href)+"&r="+_IndexRequestData.lastRequestID;var targetString="";var i;for(i=0;i<targets.length-1;i++){targetString+=targets[i]+","}targetString+=targets[i];var px_call=new Image;px_call.src=url+"&blank="+targetString}function splitIndexSlots(){var slots_O=new Array;var slots_P=new Array;for(var i=0;i<index_slots.length;i++){var index_params=index_slots[i].split("_");var op=index_params.shift();var k=op;var v=index_params.join("_");if(k==OPEN_MARKET){slots_O.push(v)}else if(k==PRIVATE_MARKET){slots_P.push(v)}}return[slots_O,slots_P]}function isSameSlot(input,test){input=input.split("_");test=test.split("_");return input.pop()==test.pop()&&input.pop()==test.pop()}function clearTargeting(targetID){var slots_O_new=[];var slots_P_new=[];var index_slots_new=[];var parts=splitIndexSlots();var slots_O=parts[0];var slots_P=parts[1];for(var i=0;i<slots_O.length;i++){if(!isSameSlot(slots_O[i],targetID)){slots_O_new.push(slots_O[i]);index_slots_new.push(OPEN_MARKET+"_"+slots_O[i])}}for(var i=0;i<slots_P.length;i++){if(!isSameSlot(slots_P[i],targetID)){slots_P_new.push(slots_P[i]);index_slots_new.push(PRIVATE_MARKET+"_"+slots_P[i])}}index_slots=index_slots_new;slots_O=slots_O_new;slots_P=slots_P_new;if(googletag&&googletag.pubads&&googletag.pubads().setTargeting){if(slots_O.length>0){googletag.pubads().setTargeting(OPEN_MARKET,slots_O)}else{googletag.pubads().setTargeting(OPEN_MARKET,[])}if(slots_P.length>0){googletag.pubads().setTargeting(PRIVATE_MARKET,slots_P)}else{googletag.pubads().setTargeting(PRIVATE_MARKET,[])}}}function cygnus_index_judge(candidate_slots){var slotTiers={};var tierExtractionRegexStr="^(?:"+OPEN_MARKET+"|"+PRIVATE_MARKET+")_(?:T([0-9])_)?(.*)$";var tierExtractionRegex=new RegExp(tierExtractionRegexStr);var private_slots=[];for(var i=0;i<candidate_slots.length;i++){if(candidate_slots[i].split("_")[0]===PRIVATE_MARKET){private_slots.push(candidate_slots[i]);continue}var match=tierExtractionRegex.exec(candidate_slots[i]);if(typeof match==="undefined"||match===null){continue}var tier,slot;tier=match[1];slot=match[2];if(typeof tier==="undefined"||tier===null){tier=0}slotTiers[slot]=slotTiers[slot]||{};if(typeof slotTiers[slot].tier==="undefined"||slotTiers[slot].tier<tier){slotTiers[slot].tier=tier;var targetID=candidate_slots[i];if(tier>0){var parts=candidate_slots[i].split("_");var market=parts.shift();var tid_nomarket_withtier=parts.join("_");parts.shift();var tid_nomarket=parts.join("_");targetID=market+"_"+tid_nomarket;_IndexRequestData.targetIDToBid[tid_nomarket]=_IndexRequestData.targetIDToBid[tid_nomarket_withtier]}slotTiers[slot].target=targetID}}var winning_slots=[];for(var slotID in slotTiers){if(slotTiers.hasOwnProperty(slotID)===false)continue;winning_slots.push(slotTiers[slotID].target)}return winning_slots.concat(private_slots)}function cygnus_index_parse_res(response){try{if(response){if(typeof _IndexRequestData!=="object"||typeof _IndexRequestData.impIDToSlotID!=="object"||typeof _IndexRequestData.impIDToSlotID[response.id]==="undefined"){return}var targetMode=0;var callbackFn;if(typeof _IndexRequestData.reqOptions==="object"&&typeof _IndexRequestData.reqOptions[response.id]==="object"){if(typeof _IndexRequestData.reqOptions[response.id].callback==="function"){callbackFn=_IndexRequestData.reqOptions[response.id].callback}if(typeof _IndexRequestData.reqOptions[response.id].targetMode==="number"){targetMode=_IndexRequestData.reqOptions[response.id].targetMode}}_IndexRequestData.lastRequestID=response.id;var allBids=[];var seatbidLength=typeof response.seatbid==="undefined"?0:response.seatbid.length;for(var i=0;i<seatbidLength;i++){for(var j=0;j<response.seatbid[i].bid.length;j++){var bid=response.seatbid[i].bid[j];if(typeof bid.ext!=="object"||typeof bid.ext.pricelevel!=="string"){continue}if(typeof _IndexRequestData.impIDToSlotID[response.id][bid.impid]==="undefined"){continue}var slotID=_IndexRequestData.impIDToSlotID[response.id][bid.impid];if(typeof index_slots==="undefined"){index_slots=[]}if(typeof _IndexRequestData.targetIDToBid==="undefined"){_IndexRequestData.targetIDToBid={}}var targetID;var targetPrefix;if(typeof bid.ext.dealid==="string"){if(targetMode===1){targetID=slotID+bid.ext.pricelevel}else{targetID=slotID+"_"+bid.ext.dealid}targetPrefix=PRIVATE_MARKET+"_"}else{targetID=slotID+bid.ext.pricelevel;targetPrefix=OPEN_MARKET+"_"}index_slots.push(targetPrefix+targetID);if(_IndexRequestData.targetIDToBid[targetID]===undefined){_IndexRequestData.targetIDToBid[targetID]=[bid.adm]}else{_IndexRequestData.targetIDToBid[targetID].push(bid.adm)}var impBid={};impBid.impressionID=bid.impid;if(typeof bid.ext.dealid!=="undefined"){impBid.dealID=bid.ext.dealid}impBid.bid=bid.price;impBid.slotID=slotID;impBid.priceLevel=bid.ext.pricelevel;impBid.target=targetPrefix+targetID;allBids.push(impBid)}}if(typeof callbackFn==="function"){if(allBids.length===0){callbackFn(response.id)}else{callbackFn(response.id,allBids)}}index_slots=cygnus_index_judge(index_slots)}}catch(e){}if(typeof index_slots==="undefined"){index_slots=[]}cygnus_index_set_targets()}function cygnus_index_set_targets(){if(typeof googletag==="undefined"){window.googletag={};window.googletag.cmd=[];googletag.cmd.unshift(function(){set_targets()})}else{if(typeof googletag.pubads!=="undefined"&&googletag.pubads().setTargeting!=="undefined"){set_targets()}else{if(googletag.cmd.unshift){googletag.cmd.unshift(function(){set_targets()})}else{googletag.cmd.push(function(){set_targets()})}}}function set_targets(){var parts=splitIndexSlots();var slots_O=parts[0];var slots_P=parts[1];googletag.pubads().clearTargeting(OPEN_MARKET);googletag.pubads().clearTargeting(PRIVATE_MARKET);googletag.pubads().setTargeting(OPEN_MARKET,[]);googletag.pubads().setTargeting(PRIVATE_MARKET,[]);if(slots_O.length>0){googletag.pubads().setTargeting(OPEN_MARKET,slots_O)}if(slots_P.length>0){googletag.pubads().setTargeting(PRIVATE_MARKET,slots_P)}}if(typeof window.cygnus_index_ready_state==="function"){window.cygnus_index_ready_state()}}function cygnus_log(msg){}function index_render(doc,targetID){clearTargeting(targetID);if(typeof index_demand==="undefined"){index_demand={}}var slotParts=targetID.split("_");var slotID=slotParts[0];for(var r=0;r<index_slots_render.length;r++){if(typeof index_slots_render[r][OPEN_MARKET+"_"+targetID]==="string"){cygnus_log("unpack tier"+targetID);targetID=index_slots_render[r][OPEN_MARKET+"_"+targetID];var parts=targetID.split("_");targetID=parts[1]+"_"+parts[2]+"_"+parts[3];slotID=parts[1]+"_"+parts[2]}}cygnus_log("index_render: "+targetID);try{var ad=_IndexRequestData.targetIDToBid[targetID].pop();if(ad!=null){doc.write(ad);cygnus_log("Logged demand for slot "+slotID);index_demand[slotID]=1;delete index_no_demand[slotID]}else{cygnus_report_blanks([targetID])}}catch(e){}}function cygnus_copy(obj){var newObj=new Object;for(var i in obj){if(obj.hasOwnProperty(i))newObj[i]=obj[i]}return newObj}function getSlotInfo(slotID){for(var i=0;i<cygnus_index_args.slots.length;i++){var slotInfo=cygnus_index_args.slots[i];if(slotInfo.id==slotID)return slotInfo}return undefined};cygnus_index_parse_res({"id": "464158471","ext": {"x3": [{"id":"131","val":1},{"id":"47","val":2},{"id":"85","val":2}]}});